Diff2Vec
============================================
<p align="justify">
Diffusion to vector is a transductive topological graph embedding procedure inspired by other sequence based graph embedding procedures. Sequences are generated by a linearized branching process. It is robust to graph densification and growth. The created embeddings are competitive with other sequence based embedding methods (e.g. DeepWalk/Node2Vec). It can be used to learn embeddings of networks with millions of nodes and it allows for parallel processing in the sequence generation and learning phases.
</p>
This repository provides a reference implementation for Diff2Vec as described in the paper:<br>
> Fast Sequence Based Embedding with Diffusion Graphs.<br>
> [Benedek Rozemberczki](http://homepages.inf.ed.ac.uk/s1668259/) and  [Rik Sarkar](https://homepages.inf.ed.ac.uk/rsarkar/).<br>
> International Conference on Complex Networks, 2018.<br>
> http://homepages.inf.ed.ac.uk/s1668259/papers/sequence.pdf


### Requirements

The codebase is implemented in Python 2.7.

### Datasets

The code takes an input graph in a csv file. Every row indicates an edge between two nodes separated by a comma. The first row is a header. A sample graph for the `Facebook Restaurants` dataset is included in the  `data/` directory.

### Options

Learning of the embedding is handled by the `main.py` script which provides the following command line arguments.

```
  --seed INT                 Random seed for numpy, tensorflow
  --datadir STR              Directory containing dataset files
  --dataset STR              Name of dataset
  --resultdir STR            Directory for saving tf checkpoints
  --run-addbgm BOOL          Runs additive boosting if True
  --addbgm-alpha FLOAT LIST  Space-separated list of model weights for additive boosting
  --run-genbgm BOOL          Runs multiplicative generative boosting if True
  --genbgm-alpha FLOAT LIST  Space-separated list of model weights for multiplicative generative boosting
  --genbgm-beta FLOAT LIST   Space-separated list of reweighting exponents for multiplicative generative boosting
  --run-discbgm BOOL         Runs multiplicative discriminative boosting if True
  --discbgm-alpha FLOAT LIST Space-separated list of model weights for multiplicative generative boosting
  --discbgm-epochs INT       Number of epochs of training for each discriminator
  --discbgm-burn-in INT      Number of discarded burn in samples for Markov chains
  --run-classifier BOOL      Uses generative model for classification if True
```

### Examples

The following commands learn a graph embedding and writes it to disk. The first column in the embedding file is the node ID.

Creating an embedding of the default dataset.

```
python src/diffusion_2_vec.py
```
Creating an embedding of an other dataset named company_edges.csv.

```
python src/diffusion_2_vec.py --input data/company_edges.csv --output emb/company.out
```

Creating an embedding of the default dataset in 32 dimensions, 5 sequences per source node with maximal sequence length of 80.

```
python src/diffusion_2_vec.py
```

### Citing

If you find Diff2Vec useful in your research, please consider citing the following paper:

>@inproceedings{rozemberczki2018fastsequence,  
  title={Fast Sequence Based Embedding with Diffusion Graphs},  
  author={Rozemberczki, Benedek and Sarkar, Rik},  
  booktitle={International Conference on Complex Networks},  
  year={2018}}
